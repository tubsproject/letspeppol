/* Modern, minimal, accessible design with light/dark support */
:root {
    /* Semantic colors */
    --bg: #f6f7fb;
    --panel: #fff;
    --muted: #6b7280;
    --text: #1f2937;
    --text-strong: #111827;
    --primary: #2563eb;
    --primary-strong: #1d4ed8;
    --accent: #14b8a6;
    --border-soft: #e5e7eb;
    --backdrop: #ffffffab;
    --border-input: #ccc;

    /* Base palette + mixes */
    --white: #fff;
    --black: #000;
    --slate-50: #f8fafc;
    --slate-600: #4b5563; /* table head text */
    --table-row-alt: #fbfdff;
    --table-row-hover: #f5f9ff;
    --badge-text-mix-base: #111;
    --btn-primary-mix-end: #3b82f6;

    /* Status colors */
    --status-ok: #10b981;       /* green */
    --status-open: #f59e0b;     /* amber */
    --status-overdue: #ef4444;  /* red */

    /* Pills (semantic aliases keep old class names) */
    --pill-invoice-fg: #2563eb;
    --pill-invoice-bg: #eef2ff;
    --pill-invoice-border: #c7d2fe;
    --pill-incoming-fg: #0ea5a4;
    --pill-incoming-bg: #ecfeff;
    --pill-incoming-border: #a7f3d0;

    /* App background decoration */
    --app-bg-base: #f5f7fb;
    --radial-blue: rgb(80 125 255 / 6%);
    --radial-teal: rgb(20 184 166 / 6%);

    /* Shadows & radii */
    --elev: 0 10px 30px rgb(0 0 0 / 35%), 0 1px 0 rgb(255 255 255 / 4%) inset;
    --shadow-header: 0 2px 8px rgb(0 0 0 / 12%);
    --shadow-card: 0 8px 24px rgb(15 23 42 / 8%);
    --shadow-soft: 0 4px 12px rgb(15 23 42 / 6%);
    --radius-lg: 10px;
    --radius-md: 8px;
    --radius-sm: 6px;
    --radius-input: .3rem;

    /* Spacing scale */
    --space-0: 0;
    --space-02: .2rem;
    --space-025: .25rem;
    --space-035: .35rem;
    --space-04: .4rem;
    --space-045: .45rem;
    --space-05: .5rem;
    --space-055: .55rem;
    --space-06: .6rem;
    --space-065: .65rem;
    --space-07: .7rem;
    --space-075: .75rem;
    --space-08: .8rem;
    --space-085: .85rem;
    --space-09: .9rem;
    --space-095: .95rem;
    --space-1: 1rem;
    --space-105: 1.05rem;
    --space-12: 1.2rem;
    --space-125: 1.25rem;
    --space-14: 1.4rem;
    --space-16: 1.6rem;
    --space-2rem: 2rem;
    --space-4rem: 4rem;

    /* Component sizing */
    --container-max: 1360px;
    --sidebar-width: 260px;
    --sticky-offset: 72px;
    --search-min-w: 220px;
    --search-min-w-mobile: 140px;
    --composer-min: 200px;
    --total-min: 150px;
    --pos-col-w: 64px;
    --modal-max-w: 560px;
}

@media (prefers-color-scheme: light) {
    :root {
        --bg: #f6f7fb;
        --panel: #fff;
        --muted: #6b7280;
        --text: #1f2937;
        --text-strong: #111827;
        --primary: #2563eb;
        --primary-strong: #1d4ed8;
        --accent: #14b8a6;
        --border-soft: #e5e7eb;
        --elev: 0 10px 30px rgb(0 0 0 / 6%);
        --shadow-card: 0 8px 28px rgb(15 23 42 / 8%);
        --shadow-soft: 0 3px 10px rgb(15 23 42 / 6%);
    }
}

/* Explicit theme override: when data-theme is set, use that theme regardless of system */
:root[data-theme="dark"] {
    --bg: #0b0c10;
    --panel: #0f1115;
    --muted: #8b93a7;
    --text: #e7eaf3;
    --text-strong: #f5f7fb;
    --primary: #6ea8fe;
    --primary-strong: #2f6fed;
    --accent: #7be3c5;
    --border-soft: #202433;
    --elev: 0 10px 30px rgb(0 0 0 / 35%), 0 1px 0 rgb(255 255 255 / 4%) inset;
    --shadow-card: 0 8px 24px rgb(15 23 42 / 8%);
    --shadow-soft: 0 4px 12px rgb(15 23 42 / 6%);
    --app-bg-base: #0b0c10;
    --radial-blue: rgb(80 125 255 / 8%);
    --radial-teal: rgb(20 184 166 / 8%);
    --table-row-alt: color-mix(in hsl, var(--panel) 92%, transparent);
    --table-row-hover: color-mix(in hsl, var(--panel) 88%, transparent);
}

:root[data-theme="light"] {
    --bg: #f6f7fb;
    --panel: #fff;
    --muted: #6b7280;
    --text: #1f2937;
    --text-strong: #111827;
    --primary: #2563eb;
    --primary-strong: #1d4ed8;
    --accent: #14b8a6;
    --border-soft: #e5e7eb;
    --elev: 0 10px 30px rgb(0 0 0 / 6%);
    --shadow-card: 0 8px 28px rgb(15 23 42 / 8%);
    --shadow-soft: 0 3px 10px rgb(15 23 42 / 6%);
    --app-bg-base: #f5f7fb;
    --radial-blue: rgb(80 125 255 / 6%);
    --radial-teal: rgb(20 184 166 / 6%);
    --table-row-alt: #fbfdff;
    --table-row-hover: #f5f9ff;
}

* { box-sizing: border-box; }
html, body { height: 100%; }
[hidden] { display: none !important; }

body {
    margin: 0;
    font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Ubuntu, Cantarell, "Noto Sans", Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    color: var(--text);
    background: radial-gradient(1200px 800px at 10% -10%, var(--radial-blue), transparent 60%),
    radial-gradient(900px 650px at 110% 10%, var(--radial-teal), transparent 60%),
    var(--app-bg-base);
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

.app-header {
    position: sticky; top: 0; z-index: 20;
    backdrop-filter: saturate(1.2) blur(8px);
    background: color-mix(in hsl, var(--bg) 70%, transparent);
    border-bottom: 1px solid var(--border-soft);
    box-shadow: var(--shadow-header);
}

.brand {
    display: flex; align-items: center; gap: var(--space-06); font-weight: 700; font-size: var(--space-105); padding: var(--space-09) var(--space-12);
}

.centered>.logo {
    position: absolute; left: 25px; top: 25px; width: 50px; height: 50px;
}
.centered>.language {
    position: absolute; right: 25px; top: 25px; width: 50px; height: 50px;
}
.header-actions { position: absolute; top: .5rem; right: .75rem; display: inline-flex; align-items: center; gap: .35rem; }
.profile-btn { appearance: none; border: 1px solid transparent; background: transparent; color: var(--text); display: inline-flex; align-items: center; gap: .5rem; padding: .25rem .5rem; border-radius: .65rem; cursor: pointer; }
.profile-btn:hover { background: color-mix(in hsl, var(--panel) 92%, transparent); }
.profile-name { font-weight: 700; color: var(--text); }
.avatar { width: 28px; height: 28px; display: grid; place-items: center; border-radius: 999px; background: color-mix(in hsl, var(--panel) 92%, var(--bg)); border: 1px solid var(--border-soft); font-size: .95rem; }
.tabs-row { display: flex; align-items: center; justify-content: space-between; gap: var(--space-05);  position: relative; }
.tabs { display: flex; gap: var(--space-025); padding: 0 var(--space-06) 0; flex-wrap: wrap; }

.tab {
    text-decoration: none;
    appearance: none; border: 1px solid transparent; background: transparent; color: var(--muted);
    padding: var(--space-055) var(--space-08); border-radius: .65rem; cursor: pointer; font-weight: 600;
}
.tab:hover { color: var(--text); }

.tab.active {
    color: var(--text-strong);
    background: linear-gradient(180deg, color-mix(in hsl, var(--panel) 88%, transparent), var(--panel));
    border-color: var(--border-soft);
    box-shadow: var(--shadow-soft);
}
.centered { height: 100vh; display: flex; justify-content: center; align-items: center;}
.container { max-width: var(--container-max); margin: var(--space-2rem) auto; padding: 0 var(--space-1) var(--space-4rem); }

main.container {
    background: var(--panel);
    border: none;
    border-radius: var(--radius-md);
    box-shadow: none;
    padding-top: var(--space-1);
    color: var(--text);
}

/* Ensure strong readability inside the light content area */
main.container .data-table tbody td { color: var(--text); }

/* .section { display: none; } */

/* .section.active { display: block; } */

.invoices-layout { display: grid; grid-template-columns: var(--sidebar-width) 1fr; gap: var(--space-125); align-items: start; }

/* When editing (sidebar hidden), use a single wide column */
.invoices-layout.sidebar-hidden { grid-template-columns: 1fr; }
.invoices-layout.sidebar-hidden .invoices-main { grid-column: 1 / -1; }
.mailbox { position: sticky; top: var(--sticky-offset); align-self: start; background: linear-gradient(180deg, color-mix(in hsl, var(--panel) 92%, transparent), var(--panel)); border: 1px solid var(--border-soft); border-radius: var(--radius-sm); box-shadow: var(--shadow-card); padding: var(--space-075); }
.mailbox-title { font-weight: 800; color: var(--muted); letter-spacing: .02em; padding: var(--space-04) var(--space-04) var(--space-02); }
.mailbox nav { display: grid; gap: var(--space-025); margin-top: var(--space-025); }
.mail-item { display: flex; justify-content: space-between; align-items: center; gap: var(--space-05); border: 1px solid transparent; background: transparent; color: var(--text); padding: var(--space-06) var(--space-07); border-radius: var(--radius-md); cursor: pointer; text-align: left; transition: background .2s ease, border-color .2s ease; }
.mail-item:hover { background: color-mix(in hsl, var(--panel) 92%, transparent); }
.mail-item.active { background: color-mix(in hsl, var(--primary) 8%, var(--panel)); border-color: color-mix(in hsl, var(--primary) 22%, var(--border-soft)); box-shadow: var(--shadow-soft); }
.mail-item .label { font-weight: 700; }
.badge { display: inline-flex; align-items: center; justify-content: center; min-width: var(--space-16); height: var(--space-125); padding: 0 var(--space-04); font-size: .78rem; border-radius: 999px; color: color-mix(in hsl, var(--primary) 60%, var(--badge-text-mix-base)); background: color-mix(in hsl, var(--primary) 10%, var(--slate-50)); border: 1px solid color-mix(in hsl, var(--primary) 22%, var(--border-soft)); }
.invoices-main { min-width: 0; }

.section-header { display: flex; align-items: center; justify-content: space-between; gap: var(--space-1); margin-bottom: var(--space-125); }
.section-header h1 { margin: 0; font-size: 1.5rem; }
.editor-header-actions { display: inline-flex; gap: var(--space-05); align-items: center; }

/* Ensure editor headers are only visible when their composers are visible */
.actions { display: flex; align-items: center; gap: var(--space-075); flex-wrap: wrap; }
.filters { display: flex; align-items: center; gap: var(--space-05); }
.select { display: grid; gap: var(--space-035); font-size: .9rem; color: var(--muted); }

.select select {
    background: var(--panel); color: var(--text); border: 1px solid var(--border-soft); border-radius: .6rem; padding: var(--space-05) var(--space-06);
}

.select input[type="date"] {
    background: var(--panel); color: var(--text); border: 1px solid var(--border-soft); border-radius: .6rem; padding: var(--space-05) var(--space-06);
}
.search { display: flex; align-items: center; gap: var(--space-04); background: var(--panel); border: 1px solid var(--border-soft); border-radius: .6rem; padding: var(--space-05) var(--space-065); }
.search input { border: none; outline: none; background: transparent; color: var(--text); min-width: var(--search-min-w); }

.btn { appearance: none; border: 1px solid var(--border-soft); background: var(--panel); color: var(--text); padding: var(--space-06) var(--space-09); border-radius: var(--radius-input); font-weight: 700; cursor: pointer; display: inline-flex; align-items: center; gap: var(--space-05); transition: transform .02s ease, box-shadow .2s ease, background .2s ease; }
.btn svg { display: block; }
.btn:hover { filter: brightness(1.03); box-shadow: var(--shadow-soft); }
.btn:active { transform: translateY(1px); }
.btn.primary { background: var(--primary); color: var(--white); border-color: color-mix(in hsl, var(--primary) 60%, var(--border-soft)); box-shadow: none; }
.btn.primary:hover { background: var(--primary-strong); border-color: var(--primary-strong); filter: none; box-shadow: var(--shadow-soft); }
.btn:focus-visible { outline: 2px solid color-mix(in hsl, var(--primary) 50%, var(--border-soft)); outline-offset: 2px; }
.btn.primary:focus-visible { outline-color: color-mix(in hsl, var(--primary) 70%, var(--border-soft)); }
.btn[disabled], .btn:disabled { opacity: .6; cursor: not-allowed; box-shadow: none; filter: none; }
.btn.ghost { border-color: transparent; background: transparent; color: var(--muted); box-shadow: none; }
.btn.ghost:hover { background: color-mix(in hsl, var(--panel) 92%, transparent); color: var(--text); box-shadow: none; }
.icon-btn { display: inline-flex; align-items: center; justify-content: center; appearance: none; border: none; background: transparent; color: var(--muted); font-size: 1.4rem; cursor: pointer; }
.icon-btn:hover { color: var(--text); }

/* Theme toggle pill */
.theme-toggle {
    display: inline-flex;      /* makes button size shrink to content */
    align-items: center;       /* vertical centering */
    justify-content: center;
    appearance: none;
    border: 1px solid var(--border-soft);
    background: var(--panel);
    color: var(--muted);
    border-radius: 999px;
    padding: var(--space-05) var(--space-07);
    font-size: 1rem;
    cursor: pointer;
    box-shadow: var(--shadow-soft);
}
.theme-toggle:hover { color: var(--text); }

.card { background: linear-gradient(180deg, color-mix(in hsl, var(--panel) 96%, transparent), var(--panel)); border: 1px solid var(--border-soft); border-radius: var(--radius-sm); box-shadow: var(--shadow-card); padding: var(--space-1); }
.table-card { padding: 0; overflow: hidden; }
.table-wrapper { overflow-x: auto; }
.data-table { width: 100%; border-collapse: separate; border-spacing: 0; font-size: .95rem; }
.data-table thead th { text-align: left; color: var(--muted); font-weight: 700; padding: var(--space-085) var(--space-1); background: var(--panel); position: sticky; top: 0; z-index: 1; border-bottom: 1px solid var(--border-soft); }
.th-filter { position: relative; }
.th-inner { display: inline-flex; align-items: center; gap: .25rem; }
.filter-toggle { font-size: .95rem; color: var(--muted); }
.filter-toggle:hover { color: var(--text); }
.filter-panel { position: absolute; top: calc(100% + .25rem); left: 0; background: var(--panel); border: 1px solid var(--border-soft); border-radius: .6rem; padding: var(--space-075); box-shadow: var(--shadow-card); display: grid; gap: var(--space-06); width: max(260px, 24vw); }
.filter-panel .panel-actions { display: flex; justify-content: flex-end; gap: var(--space-05); }
.data-table tbody td { padding: var(--space-085) var(--space-1); border-top: 1px solid var(--border-soft); }
.data-table tbody tr:nth-child(even) { background: var(--table-row-alt); }
.data-table tbody tr:hover { background: var(--table-row-hover); }
.data-table .num { text-align: right; }
.actions-col { width: 1%; white-space: nowrap; }

/* Status dot for rows */
.status-dot { display: inline-block; width: .6rem; height: .6rem; border-radius: 999px; margin-right: .4rem; vertical-align: middle; border: 1px solid var(--border-soft); cursor: pointer; }
.status-ok { background: var(--status-ok); border-color: color-mix(in hsl, var(--status-ok) 40%, var(--border-soft)); }
.status-open { background: var(--status-open); border-color: color-mix(in hsl, var(--status-open) 40%, var(--border-soft)); }
.status-overdue { background: var(--status-overdue); border-color: color-mix(in hsl, var(--status-overdue) 40%, var(--border-soft)); }

/* Dashboard */
.dashboard-grid { display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: var(--space-1); }
.kpi-card { display: grid; gap: var(--space-05); }
.kpi-header h2 { margin: 0; font-size: 1rem; color: var(--muted); }
.kpi-body { display: grid; gap: var(--space-05); }
.kpi-line { display: flex; align-items: baseline; justify-content: space-between; padding: var(--space-05) 0; border-bottom: 1px dashed var(--border-soft); }
.kpi-line:last-child { border-bottom: none; }
.kpi-line .label { color: var(--muted); }
.kpi-line strong { font-size: 1.15rem; }

.pill { display: inline-flex; align-items: center; gap: var(--space-035); border-radius: 999px; padding: var(--space-02) var(--space-05); font-size: .78rem; font-weight: 700; border: 1px solid currentcolor; }
.pill.sent { color: var(--pill-invoice-fg); background: var(--pill-invoice-bg); border-color: var(--pill-invoice-border); }
.pill.incoming { color: var(--pill-incoming-fg); background: var(--pill-incoming-bg); border-color: var(--pill-incoming-border); }

.row-actions { display: inline-flex; gap: var(--space-04); }

.row-actions .icon {
    appearance: none; border: 1px solid var(--border-soft); background: var(--panel); color: var(--muted); border-radius: .55rem; padding: var(--space-035) var(--space-045); cursor: pointer; display: inline-flex; align-items: center; justify-content: center;
}
.row-actions .icon svg { display: block; color: currentcolor; }
.row-actions .icon:hover { color: var(--text); }

.empty-state { text-align: center; padding: var(--space-2rem); color: var(--muted); }
.empty-icon { font-size: 0; margin-bottom: var(--space-025); color: var(--muted); }

/* Pager */
.table-footer.pager { display: flex; align-items: center; justify-content: space-between; gap: var(--space-075); padding: var(--space-075) var(--space-1); border-top: 1px solid var(--border-soft); background: var(--panel); }
.pager-range { color: var(--muted); }

/* Modal */

/* Modal (generic) */
.modal[hidden] { display: none; }
.modal { position: fixed; inset: 0; display: grid; place-items: center; z-index: 50; }
.modal-backdrop { position: absolute; inset: 0; background: color-mix(in hsl, var(--backdrop) 70%, black); }
.modal-card { position: relative; width: min(var(--modal-max-w), calc(100% - var(--space-2rem))); background: var(--panel); border: 1px solid var(--border-soft); border-radius: var(--radius-md) ; box-shadow: var(--elev); overflow: hidden; }
.modal-header { display: flex; align-items: center; justify-content: space-between; padding: var(--space-1) var(--space-1) var(--space-05); }
.modal-header > * { margin-top: unset; margin-bottom: unset; }
.modal-body { padding: 0 var(--space-1) var(--space-1); }
.modal-footer { display: flex; justify-content: flex-end; gap: var(--space-05); padding: var(--space-075) var(--space-1) var(--space-1); border-top: 1px dashed var(--border-soft); margin-top: var(--space-05); }

/* Composer */
.composer-card { margin-bottom: var(--space-1); }
.composer-head { display: grid; grid-template-columns: 1fr auto auto auto; gap: var(--space-1); align-items: start; margin-bottom: var(--space-1); }
.composer-info { display: grid; align-content: center; gap: var(--space-025); justify-items: start; padding: var(--space-075) var(--space-1); background: linear-gradient(180deg, color-mix(in hsl, var(--panel) 92%, transparent), var(--panel)); border: 1px solid var(--border-soft); border-radius: var(--radius-md); min-width: var(--composer-min); }
.total-display { display: grid; align-content: center; gap: var(--space-025); justify-items: end; padding: var(--space-075) var(--space-1); background: linear-gradient(180deg, color-mix(in hsl, var(--panel) 92%, transparent), var(--panel)); border: 1px solid var(--border-soft); border-radius: var(--radius-md); min-width: var(--total-min); }
.total-display span, .composer-info span { color: var(--muted); font-size: .85rem; }
.total-display strong, .composer-info strong { font-size: 1.25rem; }
.composer-actions-top { display: inline-flex; gap: var(--space-05); align-items: center; justify-content: flex-end; margin-bottom: var(--space-05); }
.head-right { display: grid; gap: var(--space-05); justify-items: end; }

.line-items { display: grid; gap: var(--space-075); }
.line-items-head { display: flex; align-items: center; justify-content: space-between; padding: var(--space-025) var(--space-025) 0; }
.line-items-head h3 { margin: 0; font-size: 1rem; color: var(--muted); }
.line-table thead th { position: sticky; top: 0; }
.line-table input, .line-table textarea { width: 100%; border: 1px solid var(--border-soft); background: var(--bg); color: var(--text); border-radius: var(--radius-input); padding: var(--space-045) var(--space-05); font: inherit; }
.line-table select { border: 1px solid var(--border-soft); background: var(--bg); color: var(--text); border-radius: var(--radius-input); padding: var(--space-045) var(--space-05); font: inherit; }
.line-table textarea { min-height: 40px; resize: vertical; }
.line-table .pos { width: var(--pos-col-w); text-align: center; }
.line-table .num input { text-align: right; }

/* Footer removed; actions now in top-right */

.grid { display: grid; grid-template-columns: repeat(5, minmax(0, 1fr)); gap: var(--space-09); }
.field { display: grid; gap: var(--space-035); }
.field.full { grid-column: 1 / -1; }
.field span { color: var(--muted); font-size: .85rem; }

.field input, .field select {
    min-width: 0;
    border: 1px solid var(--border-input);
    border-radius: var(--radius-input);
    background: var(--bg);
    box-shadow: rgb(31 41 55 / 6%) 0 1px 1px 0;
    color: var(--text);
    padding: var(--space-05) var(--space-065);
}

.field input::placeholder {
    opacity: 0.6;
}
.field textarea { border: 1px solid var(--border-soft); background: var(--bg); color: var(--text); border-radius: .6rem; padding: var(--space-06) var(--space-07); min-height: 72px; resize: vertical; }
.field input:focus, .field select:focus { outline: 2px solid color-mix(in hsl, var(--primary) 40%, var(--border-soft)); outline-offset: 1px; }
.field input:disabled, .field textarea:disabled, .field input:read-only, .field textarea:read-only { border: 1px solid var(--border-soft) }

/* Auth */
.auth-card { max-width: 640px; margin: 0 auto; }
.auth-form { display: grid; gap: var(--space-1); }
.auth-actions { display: flex; justify-content: flex-end; }
.auth-alt { color: var(--muted); margin: 0; }
.auth-alt a { color: var(--primary); text-decoration: none; }
.auth-alt a:hover { text-decoration: underline; }

/* Inline form error message */
.form-error {
    justify-content: start;
    margin: 0;
    font-size: .85rem;
    line-height: 1.3;
    color: var(--status-overdue);
    padding: var(--space-05) var(--space-075);
    border-radius: var(--radius-input);
    display: flex;
    align-items: center;
    gap: .4rem;
    animation: fade-in .5s ease;
    background: #fdeff1;
    position: relative;
}

.form-error::before {
    content: url("data:image/svg+xml, <svg xmlns='http://www.w3.org/2000/svg' width='18' height='18' viewBox='0 0 24 24' fill='none' stroke='%23ef4444' stroke-width='2' stroke-linecap='round' stroke-linejoin='round' class='lucide lucide-triangle-alert-icon lucide-triangle-alert'><path d='m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3'/><path d='M12 9v4'/><path d='M12 17h.01'/></svg>");
    font-size: .95rem;
    line-height: 1;
}

/* Small fade-in for dynamic feedback */
@keyframes fade-in {
    from { opacity: 0;  }
    to { opacity: 1; }
}

:root[data-theme="dark"] .form-error {
    background: color-mix(in hsl, var(--status-overdue) 28%, #1a0d0e);
    box-shadow: 0 0 0 1px color-mix(in hsl, var(--status-overdue) 35%, transparent);
}
